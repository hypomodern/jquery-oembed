(function(e,b){e.fn.oembed=function(o,n,m){c=e.extend(true,e.fn.oembed.defaults,n);j();return this.each(function(){var p=e(this),q=(o!=null)?o:p.attr("href"),r;if(m){c.onEmbed=m}else{c.onEmbed=function(s){e.fn.oembed.insertCode(this,c.embedMethod,s)}}if(q!=null){r=h(q);if(r!=null){r.params=k(c[r.name])||{};r.maxWidth=c.maxWidth;r.maxHeight=c.maxHeight;a(p,q,r)}else{c.onProviderNotFound.call(p,q)}return p}})};var c,f=[];e.fn.oembed.defaults={maxWidth:null,maxHeight:null,embedMethod:"replace",defaultOEmbedProvider:"oohembed",allowedProviders:null,disallowedProviders:null,customProviders:null,defaultProvider:null,greedy:true,onProviderNotFound:function(){},beforeEmbed:function(){},afterEmbed:function(){},onEmbed:function(){}};function l(r,q){var n=r.apiendpoint,m="",p=r.callbackparameter||"callback",o;if(n.indexOf("?")<=0){n=n+"?"}else{n=n+"&"}if(r.maxWidth!=null&&r.params.maxwidth==null){r.params.maxwidth=r.maxWidth}if(r.maxHeight!=null&&r.params.maxheight==null){r.params.maxheight=r.maxHeight}for(o in r.params){if(o==r.callbackparameter){continue}if(r.params[o]!=null){m+="&"+escape(o)+"="+r.params[o]}}n+="format=json&url="+escape(q)+m+"&"+p+"=?";return n}function a(m,p,n){var o=l(n,p);e.getJSON(o,function(r){var q=e.extend({},r);switch(q.type){case"photo":q.code=e.fn.oembed.getPhotoCode(p,q);break;case"video":q.code=e.fn.oembed.getVideoCode(p,q);break;case"rich":q.code=e.fn.oembed.getRichCode(p,q);break;default:q.code=e.fn.oembed.getGenericCode(p,q);break}c.beforeEmbed.call(m,q);c.onEmbed.call(m,q);c.afterEmbed.call(m,q)})}function h(m){for(var n=0;n<f.length;n++){if(f[n].matches(m)){return f[n]}}return null}function j(){f=[];var n,m=[];if(!d(c.allowedProviders)){for(i=0;i<e.fn.oembed.providers.length;i++){if(e.inArray(e.fn.oembed.providers[i].name,c.allowedProviders)>=0){f.push(e.fn.oembed.providers[i])}}c.greedy=false}else{f=e.fn.oembed.providers}if(!d(c.disallowedProviders)){for(i=0;i<f.length;i++){if(e.inArray(f[i].name,c.disallowedProviders)<0){m.push(f[i])}}f=m;c.greedy=false}if(!d(c.customProviders)){e.each(c.customProviders,function(o,p){if(p instanceof e.fn.oembed.OEmbedProvider){f.push(provider)}else{provider=new e.fn.oembed.OEmbedProvider();if(provider.fromJSON(p)){f.push(provider)}}})}n=g(c.defaultOEmbedProvider);if(c.greedy==true){f.push(n)}e.each(f,function(p,o){if(f[p].apiendpoint==null){f[p].apiendpoint=n.apiendpoint}})}function g(m){var n="http://oohembed.com/oohembed/";if(m=="embed.ly"){n="http://api.embed.ly/v1/api/oembed?"}return new e.fn.oembed.OEmbedProvider(m,null,null,n,"callback")}function k(o){if(o==null){return null}var m,n={};for(m in o){if(m!=null){n[m.toLowerCase()]=o[m]}}return n}function d(m){if(typeof m=="undefined"){return true}if(m==null){return true}if(e.isArray(m)&&m.length==0){return true}return false}e.fn.oembed.insertCode=function(m,o,n){if(n==null){return}switch(o){case"auto":if(m.attr("href")!=null){e.fn.oembed.insertCode(m,"append",n)}else{e.fn.oembed.insertCode(m,"replace",n)}break;case"replace":m.replaceWith(n.code);break;case"fill":m.html(n.code);break;case"append":var p=m.next();if(p==null||!p.hasClass("oembed-container")){p=m.after('<div class="oembed-container"></div>').next(".oembed-container");if(n!=null&&n.provider_name!=null){p.toggleClass("oembed-container-"+n.provider_name)}}p.html(n.code);break}};e.fn.oembed.getPhotoCode=function(m,n){var o,p=n.title?n.title:"";p+=n.author_name?" - "+n.author_name:"";p+=n.provider_name?" - "+n.provider_name:"";o='<div><a href="'+m+"\" target='_blank'><img src=\""+n.url+'" alt="'+p+'"/></a></div>';if(n.html){o+="<div>"+n.html+"</div>"}return o};e.fn.oembed.getVideoCode=function(m,n){var o=n.html;return o};e.fn.oembed.getRichCode=function(m,n){var o=n.html;return o};e.fn.oembed.getGenericCode=function(m,n){var p=(n.title!=null)?n.title:m,o='<a href="'+m+'">'+p+"</a>";if(n.html){o+="<div>"+n.html+"</div>"}return o};e.fn.oembed.isProviderAvailable=function(m){var n=h(m);return(n!=null)};e.fn.oembed.OEmbedProvider=function(n,r,t,o,p){this.name=n;this.type=r;this.urlschemes=m(t);this.apiendpoint=o;this.callbackparameter=p;this.maxWidth=500;this.maxHeight=400;var q,u,s;this.matches=function(v){for(q=0;q<this.urlschemes.length;q++){s=new RegExp(this.urlschemes[q],"i");if(v.match(s)!=null){return true}}return false};this.fromJSON=function(v){for(u in v){if(u!="urlschemes"){this[u]=v[u]}else{this[u]=m(v[u])}}return true};function m(v){if(d(v)){return["."]}if(e.isArray(v)){return v}return v.split(";")}};e.fn.oembed.providers=[new e.fn.oembed.OEmbedProvider("youtube","video",["youtube\\.com/watch.+v=[\\w-]+&?"]),new e.fn.oembed.OEmbedProvider("flickr","photo",["flickr\\.com/photos/[-.\\w@]+/\\d+/?"],"http://flickr.com/services/oembed","jsoncallback"),new e.fn.oembed.OEmbedProvider("viddler","video",["viddler.com"]),new e.fn.oembed.OEmbedProvider("blip","video",["blip\\.tv/.+"],"http://blip.tv/oembed/"),new e.fn.oembed.OEmbedProvider("hulu","video",["hulu\\.com/watch/.*"],"http://www.hulu.com/api/oembed.json"),new e.fn.oembed.OEmbedProvider("vimeo","video",["http://www.vimeo.com/groups/.*/videos/.*","http://www.vimeo.com/.*","http://vimeo.com/groups/.*/videos/.*","http://vimeo.com/.*"],"http://vimeo.com/api/oembed.json"),new e.fn.oembed.OEmbedProvider("dailymotion","video",["dailymotion\\.com/.+"]),new e.fn.oembed.OEmbedProvider("scribd","rich",["scribd\\.com/.+"]),new e.fn.oembed.OEmbedProvider("slideshare","rich",["slideshare.net"],"http://www.slideshare.net/api/oembed/1"),new e.fn.oembed.OEmbedProvider("photobucket","photo",["photobucket\\.com/(albums|groups)/.*"],"http://photobucket.com/oembed/")]})(jQuery);